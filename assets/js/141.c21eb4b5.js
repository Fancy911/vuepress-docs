(window.webpackJsonp=window.webpackJsonp||[]).push([[141],{662:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"同源策略"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同源策略"}},[s._v("#")]),s._v(" 同源策略")]),s._v(" "),t("p",[s._v("同源策略 (Same-Origin Policy) 最早由 Netscape 公司提出，是浏览器的一种安全策略。")]),s._v(" "),t("ul",[t("li",[s._v("同源: 协议、域名、端口号 必须完全相同。")]),s._v(" "),t("li",[s._v("违背同源策略就是跨域。")]),s._v(" "),t("li",[t("code",[s._v("ajax")]),s._v("请求默认遵守同源策略，如果不遵守，就会报错。")])]),s._v(" "),t("h3",{attrs:{id:"同源策略示例demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#同源策略示例demo"}},[s._v("#")]),s._v(" 同源策略示例demo")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/Fancy911/ajax-learning-demo/tree/main/5.%E8%B7%A8%E5%9F%9F/5.1-%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5",target:"_blank",rel:"noopener noreferrer"}},[s._v("同源策略Demo"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"如何解决跨域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何解决跨域"}},[s._v("#")]),s._v(" 如何解决跨域")]),s._v(" "),t("h3",{attrs:{id:"_1-jsonp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-jsonp"}},[s._v("#")]),s._v(" 1.JSONP")]),s._v(" "),t("h4",{attrs:{id:"jsonp是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jsonp是什么"}},[s._v("#")]),s._v(" JSONP是什么？")]),s._v(" "),t("p",[t("code",[s._v("JSONP")]),s._v(" (JSON with Padding) 是"),t("code",[s._v("JSON")]),s._v('的一种"使用模式"，可用于解决主流浏览器的跨域数据访问的问题。它是一个非官方的跨域解决方案，纯粹凭借程序员的聪明才智开发出来，只支持 '),t("code",[s._v("get")]),s._v(" 请求。")]),s._v(" "),t("h4",{attrs:{id:"jsonp的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jsonp的原理"}},[s._v("#")]),s._v(" JSONP的原理")]),s._v(" "),t("p",[s._v("在网页有一些标签天生具有跨域能力，比如:"),t("code",[s._v("img")]),s._v(" "),t("code",[s._v("link")]),s._v(" "),t("code",[s._v("iframe")]),s._v(" "),t("code",[s._v("script")]),s._v("。")]),s._v(" "),t("p",[t("code",[s._v("JSONP")]),s._v(" 就是利用 "),t("code",[s._v("script")]),s._v(" 标签的跨域能力来发送请求的。")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//jsonp服务")]),s._v("\napp"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("all")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/jsonp-server'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" response")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这样写是不行的，因为这样写的话，浏览器会当做普通的字符串来处理，而不是当做js代码来处理")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// response.send("hello jsonp");')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 而我们jsonp解决跨域的原理是，客户端会先动态的创建一个script标签，然后将这个script标签插入到页面中")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这个script标签的src属性就是我们要请求的地址")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 服务端返回的内容就是这个script标签的内容")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 所以我们要返回的内容必须是一个js代码")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 但是我们不能直接返回一个js代码，因为这样的话，浏览器会当做普通的字符串来处理，而不是当做js代码来处理")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 所以我们要将js代码包裹在一个函数中，然后返回这个函数的调用")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// response.send('console.log(\"hello jsonp\")');  // 这样写就是ok的")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" data "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lizhiwei哈哈哈哈'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//将数据转化为字符串")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("let")]),s._v(" str "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 返回结果")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 服务端的返回结果是一个函数调用")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 而函数的参数就是我们要给客户端返回的数据")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注意：这个函数，客户端要提前定义好，否则会报错")]),s._v("\n    response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("end")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token template-string"}},[t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("handle(")]),t("span",{pre:!0,attrs:{class:"token interpolation"}},[t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("${")]),s._v("str"),t("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[s._v("}")])]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[s._v("`")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("h4",{attrs:{id:"jsonp的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jsonp的使用"}},[s._v("#")]),s._v(" JSONP的使用")]),s._v(" "),t("ol",[t("li",[s._v("动态的创建一个 "),t("code",[s._v("script")]),s._v(" 标签")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" script "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" document"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createElement")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"script"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[s._v("设置"),t("code",[s._v("script")]),s._v("的 "),t("code",[s._v("src")]),s._v("，设置回调函数")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置 script 的 src")]),s._v("\nscript"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("src "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost:3000/testAJAX?callback=abc"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 设置回调函数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("abc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("data")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("alert")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("data"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[s._v("将"),t("code",[s._v("script")]),s._v("添加到"),t("code",[s._v("body")]),s._v("中")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("document"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("body"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("appendChild")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("ol",{attrs:{start:"4"}},[t("li",[s._v("服务器中路由的处理")])]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testAJAX"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" response")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"收到请求"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" callback "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("callback"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" obj "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"孙悟空"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("age")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    response"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" callback"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"("')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("JSON")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("stringify")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("obj"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('")"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("一个"),t("code",[s._v("jsonp")]),s._v("的简单案例：页面上有一个用户名输入框，当用户输入用户名后，失去焦点，页面会自动提示用户名是否可用。")]),s._v(" "),t("p",[s._v("具体的代码如下：")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/Fancy911/ajax-learning-demo/tree/main/5.%E8%B7%A8%E5%9F%9F/5.2-JSONP",target:"_blank",rel:"noopener noreferrer"}},[s._v("客户端代码示例"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/Fancy911/ajax-learning-demo/blob/main/server.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("服务端代码示例"),t("OutboundLink")],1)])])]),t("h4",{attrs:{id:"jquery-中的-jsonp"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jquery-中的-jsonp"}},[s._v("#")]),s._v(" jQuery 中的 JSONP")]),s._v(" "),t("p",[t("code",[s._v("jQuery")]),s._v(" 中的 "),t("code",[s._v("JSONP")]),s._v(" 是通过 "),t("code",[s._v("$.ajax()")]),s._v(" 方法来实现的。")]),s._v(" "),t("p",[s._v("具体代码也是同样参考github中的示例。")]),s._v(" "),t("h3",{attrs:{id:"_2-cors"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-cors"}},[s._v("#")]),s._v(" 2."),t("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS",target:"_blank",rel:"noopener noreferrer"}},[s._v("CORS"),t("OutboundLink")],1)]),s._v(" "),t("h4",{attrs:{id:"cors是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cors是什么"}},[s._v("#")]),s._v(" CORS是什么")]),s._v(" "),t("p",[t("code",[s._v("CORS")]),s._v(" (Cross-Origin Resource Sharing)，跨域资源共享。")]),s._v(" "),t("p",[t("code",[s._v("CORS")]),s._v(" 是官方的跨域解决方案，它的特点是"),t("strong",[s._v("不需要在客户端做任何特殊的操作，完全在服务器中进行处理")]),s._v("，支持 "),t("code",[s._v("get")]),s._v(" 和 "),t("code",[s._v("post")]),s._v(" 请求。跨域资源共享标准新增了一组 "),t("code",[s._v("HTTP")]),s._v(" 首部字段，允许服务器声明哪些源站通过浏览器有权限访问哪些资源。")]),s._v(" "),t("h4",{attrs:{id:"cors的原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cors的原理"}},[s._v("#")]),s._v(" CORS的原理")]),s._v(" "),t("p",[t("code",[s._v("CORS")]),s._v(" 是通过设置一个响应头来告诉浏览器，该请求允许跨域，浏览器收到该响应 以后就会对响应放行。")]),s._v(" "),t("h4",{attrs:{id:"cors的使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cors的使用"}},[s._v("#")]),s._v(" CORS的使用")]),s._v(" "),t("p",[s._v("主要是服务器端的设置:")]),s._v(" "),t("div",{staticClass:"language-js line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("app"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("get")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/testAJAX"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("request"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" response")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//通过 res 来设置响应头，来允许跨域请求")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//res.set("Access-Control-Allow-Origin","http://127.0.0.1:3000"); ')]),s._v("\n    res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("set")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Access-Control-Allow-Origin"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    res"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("send")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"testAJAX 返回的响应"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("p",[s._v("具体的代码如下：")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://github.com/Fancy911/ajax-learning-demo/tree/main/5.%E8%B7%A8%E5%9F%9F/5.3-CORS",target:"_blank",rel:"noopener noreferrer"}},[s._v("客户端代码示例"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/Fancy911/ajax-learning-demo/blob/main/server.js",target:"_blank",rel:"noopener noreferrer"}},[s._v("服务端代码示例"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);